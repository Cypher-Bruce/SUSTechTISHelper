if("undefined"==typeof unsafeWindow)if(0==$(".ivu-table-header").length){let e=void 0,t=$(".footer-main-list .mains-navbtn");for(let n=0;n<t.length;n++)if("我要选课"==t[n].innerHTML){e=n;break}null==e&&console.error("加载失败，请确保您的console是在tis上打开的，并且已进入“我要选课”页面"),unsafeWindow=window.frames[e]}else unsafeWindow=window;const timetableType=[[{index:"1",name:"8:00"},1],[{index:"2",name:"9:00"},1],[{index:"3",name:"10:20"},1],[{index:"4",name:"11:20"},1],[{index:"5",name:"14:00"},1],[{index:"6",name:"15:00"},1],[{index:"7",name:"16:20"},1],[{index:"8",name:"17:20"},1],[{index:"9",name:"19:00"},1],[{index:"10",name:"20:00"},1],[{index:"11",name:"21:10"},1]],week=["周一","周二","周三","周四","周五"];var timetable=void 0,loadedCustomCourseTable=!1;const weekday={"一":0,"二":1,"三":2,"四":3,"五":4};function genTimetableOption(e){let t={timetables:unsafeWindow.timetableArray,week:week,timetableType:timetableType,styles:{Gheight:($(unsafeWindow).height()-85)/11,leftHandWidth:30},gridOnClick:function(e){if(unsafeWindow.lastClicked==e&&""!=e){for(let t=0;t<unsafeWindow.timetableArray.length;t++)for(let n=0;n<unsafeWindow.timetableArray[t].length;n++)unsafeWindow.timetableArray[t][n]=unsafeWindow.timetableArray[t][n].filter(function(t){return t!==e});localStorage.setItem("timetableArray",JSON.stringify(unsafeWindow.timetableArray)),unsafeWindow.timetable.setOption(genTimetableOption(!1))}unsafeWindow.lastClicked=e}};return e&&(t.el="#courseTable"),t}function addBtn(){const e=$(".ivu-table-body.ivu-table-overflowY .ivu-table-row");if(0==$("td:first button",e).length){if(!loadedCustomCourseTable&&0!=$(".ivu-layout-header button").eq(6).length){let e=$('<div class="modal"><div class="modal-content">                 <div class="modal-header"><span class="close">&times;</span>                 <span class="modal-title">双击删除某门课</span></div>                <div class="modal-body" id="courseTable"></div></div></div>');$(".close",e).on("click",function(){e.hide()}),e.on("click",function(){e.hide()}).children().on("click",function(e){e.stopPropagation()});let t=$('<button class="ivu-btn ivu-btn-info">                 <span>暂存课表查看</span></button>');t.on("click",function(){e.show(),unsafeWindow.timetable.setOption(genTimetableOption(!1))});let n=$('<button class="ivu-btn ivu-btn-info">                 <span>清空暂存课表</span></button>');n.on("click",function(){confirm("确认清空暂存课表吗？")&&(unsafeWindow.timetableArray=[[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]]],localStorage.setItem("timetableArray",JSON.stringify(unsafeWindow.timetableArray)))}),$(".ivu-layout-header button").eq(6).after(n).after(t),$("#app").append(e),unsafeWindow.timetableArray=JSON.parse(localStorage.getItem("timetableArray"))||[[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]],[[],[],[],[],[],[],[],[],[],[],[]]],unsafeWindow.timetable=new Timetables(genTimetableOption(!0)),e.hide(),unsafeWindow.addToStashTable=function(e){const t=$("td",e.parentNode.parentNode),n=$("span",t[0]).html(),a=$("a",t[8]).html(),i=[];$(".ivu-tag-cyan p",t[8]).each(function(){i.push(this.innerHTML)});let o=!1;for(let e of i){let t=e.match("星期(.)第(\\d+)-(\\d+)节");for(let e=t[2]-1;e<t[3];e++){let i=n+" "+a;unsafeWindow.timetableArray[weekday[t[1]]][e].includes(i)||(unsafeWindow.timetableArray[weekday[t[1]]][e].push(i),o=!0)}}o&&localStorage.setItem("timetableArray",JSON.stringify(unsafeWindow.timetableArray))},loadedCustomCourseTable=!0}e.each(function(){let e=$('<button type="button"             class="ivu-btn ivu-btn-success ivu-btn-small"><span>暂存</span></button>');e.on("click",function(){addToStashTable(this)}),$("td:first",this).append(e)})}}!function(){"use strict";"undefined"!=typeof unsafeWindow&&setInterval(addBtn,500)}();